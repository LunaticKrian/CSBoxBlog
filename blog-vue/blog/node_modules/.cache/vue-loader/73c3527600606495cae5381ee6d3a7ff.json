{"remainingRequest":"E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\src\\components\\ChatRoom.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\src\\components\\ChatRoom.vue","mtime":1678940307222},{"path":"E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\work\\project\\CSBoxBlog\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgUmVjb3JkZXJ4LCB7IEVOQ09ERV9UWVBFIH0gZnJvbSAicmVjb3JkZXJ4IjsNCmltcG9ydCBFbW9qaSBmcm9tICIuL0Vtb2ppIjsNCmltcG9ydCBFbW9qaUxpc3QgZnJvbSAiLi4vYXNzZXRzL2pzL2Vtb2ppIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgIEVtb2ppDQogIH0sDQogIHVwZGF0ZWQoKSB7DQogICAgdmFyIGVsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtZXNzYWdlIik7DQogICAgZWxlLnNjcm9sbFRvcCA9IGVsZS5zY3JvbGxIZWlnaHQ7DQogIH0sDQogIGJlZm9yZURlc3Ryb3koKSB7DQogICAgY2xlYXJJbnRlcnZhbCh0aGlzLmhlYXJ0QmVhdCk7DQogIH0sDQogIGRhdGE6IGZ1bmN0aW9uKCkgew0KICAgIHJldHVybiB7DQogICAgICBpc0Vtb2ppOiBmYWxzZSwNCiAgICAgIGlzU2hvdzogZmFsc2UsDQogICAgICB3ZWJzb2NrZXQ6IG51bGwsDQogICAgICBjb250ZW50OiAiIiwNCiAgICAgIGNoYXRSZWNvcmRMaXN0OiBbXSwNCiAgICAgIHZvaWNlTGlzdDogW10sDQogICAgICByYzogbnVsbCwNCiAgICAgIGlwQWRkcmVzczogIiIsDQogICAgICBpcFNvdXJjZTogIiIsDQogICAgICBjb3VudDogMCwNCiAgICAgIHVucmVhZENvdW50OiAwLA0KICAgICAgaXNWb2ljZTogZmFsc2UsDQogICAgICB2b2ljZUFjdGl2ZTogZmFsc2UsDQogICAgICBzdGFydFZvaWNlVGltZTogbnVsbCwNCiAgICAgIFdlYnNvY2tldE1lc3NhZ2U6IHsNCiAgICAgICAgdHlwZTogbnVsbCwNCiAgICAgICAgZGF0YTogbnVsbA0KICAgICAgfSwNCiAgICAgIGhlYXJ0QmVhdDogbnVsbA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBvcGVuKCkgew0KICAgICAgaWYgKHRoaXMud2Vic29ja2V0ID09IG51bGwpIHsNCiAgICAgICAgdGhpcy5jb25uZWN0KCk7DQogICAgICB9DQogICAgICB0aGlzLnVucmVhZENvdW50ID0gMDsNCiAgICAgIHRoaXMuaXNTaG93ID0gIXRoaXMuaXNTaG93Ow0KICAgIH0sDQogICAgb3BlbkVtb2ppKCkgew0KICAgICAgdGhpcy5pc0Vtb2ppID0gIXRoaXMuaXNFbW9qaTsNCiAgICAgIHRoaXMuaXNWb2ljZSA9IGZhbHNlOw0KICAgIH0sDQogICAgY29ubmVjdCgpIHsNCiAgICAgIHZhciB0aGF0ID0gdGhpczsNCiAgICAgIHRoaXMud2Vic29ja2V0ID0gbmV3IFdlYlNvY2tldCh0aGlzLmJsb2dJbmZvLndlYnNpdGVDb25maWcud2Vic29ja2V0VXJsKTsNCiAgICAgIC8vIOi/nuaOpeWPkeeUn+mUmeivr+eahOWbnuiwg+aWueazlQ0KICAgICAgdGhpcy53ZWJzb2NrZXQub25lcnJvciA9IGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgICAgIGNvbnNvbGUubG9nKGV2ZW50KTsNCiAgICAgICAgYWxlcnQoIuWksei0pSIpOw0KICAgICAgfTsNCiAgICAgIC8vIOi/nuaOpeaIkOWKn+W7uueri+eahOWbnuiwg+aWueazlQ0KICAgICAgdGhpcy53ZWJzb2NrZXQub25vcGVuID0gZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgY29uc29sZS5sb2coZXZlbnQpOw0KICAgICAgICAvLyDlj5HpgIHlv4Pot7Pmtojmga8NCiAgICAgICAgdGhhdC5oZWFydEJlYXQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsNCiAgICAgICAgICB2YXIgYmVhdE1lc3NhZ2UgPSB7DQogICAgICAgICAgICB0eXBlOiA2LA0KICAgICAgICAgICAgZGF0YTogInBpbmciDQogICAgICAgICAgfTsNCiAgICAgICAgICB0aGF0LndlYnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KGJlYXRNZXNzYWdlKSk7DQogICAgICAgIH0sIDMwICogMTAwMCk7DQogICAgICB9Ow0KICAgICAgLy8g5o6l5pS25Yiw5raI5oGv55qE5Zue6LCD5pa55rOVDQogICAgICB0aGlzLndlYnNvY2tldC5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkgew0KICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTsNCiAgICAgICAgc3dpdGNoIChkYXRhLnR5cGUpIHsNCiAgICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICAvLyDlnKjnur/kurrmlbANCiAgICAgICAgICAgIHRoYXQuY291bnQgPSBkYXRhLmRhdGE7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICAvLyDljoblj7LorrDlvZUNCiAgICAgICAgICAgIHRoYXQuY2hhdFJlY29yZExpc3QgPSBkYXRhLmRhdGEuY2hhdFJlY29yZExpc3Q7DQogICAgICAgICAgICB0aGF0LmNoYXRSZWNvcmRMaXN0LmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgIGlmIChpdGVtLnR5cGUgPT0gNSkgew0KICAgICAgICAgICAgICAgIHRoYXQudm9pY2VMaXN0LnB1c2goaXRlbS5pZCk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdGhhdC5pcEFkZHJlc3MgPSBkYXRhLmRhdGEuaXBBZGRyZXNzOw0KICAgICAgICAgICAgdGhhdC5pcFNvdXJjZSA9IGRhdGEuZGF0YS5pcFNvdXJjZTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgMzoNCiAgICAgICAgICAgIC8vIOaWh+Wtl+a2iOaBrw0KICAgICAgICAgICAgdGhhdC5jaGF0UmVjb3JkTGlzdC5wdXNoKGRhdGEuZGF0YSk7DQogICAgICAgICAgICBpZiAoIXRoYXQuaXNTaG93KSB7DQogICAgICAgICAgICAgIHRoYXQudW5yZWFkQ291bnQrKzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgNDoNCiAgICAgICAgICAgIC8vIOaSpOWbng0KICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS5pc1ZvaWNlKSB7DQogICAgICAgICAgICAgIHRoYXQudm9pY2VMaXN0LnNwbGljZSh0aGF0LnZvaWNlTGlzdC5pbmRleE9mKGRhdGEuZGF0YS5pZCksIDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGF0LmNoYXRSZWNvcmRMaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgIGlmICh0aGF0LmNoYXRSZWNvcmRMaXN0W2ldLmlkID09IGRhdGEuZGF0YS5pZCkgew0KICAgICAgICAgICAgICAgIHRoYXQuY2hhdFJlY29yZExpc3Quc3BsaWNlKGksIDEpOw0KICAgICAgICAgICAgICAgIGktLTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgY2FzZSA1Og0KICAgICAgICAgICAgLy8g6K+t6Z+z5raI5oGvDQogICAgICAgICAgICB0aGF0LnZvaWNlTGlzdC5wdXNoKGRhdGEuZGF0YS5pZCk7DQogICAgICAgICAgICB0aGF0LmNoYXRSZWNvcmRMaXN0LnB1c2goZGF0YS5kYXRhKTsNCiAgICAgICAgICAgIGlmICghdGhhdC5pc1Nob3cpIHsNCiAgICAgICAgICAgICAgdGhhdC51bnJlYWRDb3VudCsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgIH07DQogICAgICAvL+i/nuaOpeWFs+mXreeahOWbnuiwg+aWueazlQ0KICAgICAgdGhpcy53ZWJzb2NrZXQub25jbG9zZSA9IGZ1bmN0aW9uKCkge307DQogICAgfSwNCiAgICBzYXZlTWVzc2FnZShlKSB7DQogICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICBpZiAodGhpcy5jb250ZW50LnRyaW0oKSA9PSAiIikgew0KICAgICAgICB0aGlzLiR0b2FzdCh7IHR5cGU6ICJlcnJvciIsIG1lc3NhZ2U6ICLlhoXlrrnkuI3og73kuLrnqboiIH0pOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICAvL+ino+aekOihqOaDhQ0KICAgICAgdmFyIHJlZyA9IC9cWy4rP1xdL2c7DQogICAgICB0aGlzLmNvbnRlbnQgPSB0aGlzLmNvbnRlbnQucmVwbGFjZShyZWcsIGZ1bmN0aW9uKHN0cikgew0KICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICI8aW1nIHNyYz0gJyIgKw0KICAgICAgICAgIEVtb2ppTGlzdFtzdHJdICsNCiAgICAgICAgICAiJyB3aWR0aD0nMjQnaGVpZ2h0PScyNCcgc3R5bGU9J21hcmdpbjogMCAxcHg7dmVydGljYWwtYWxpZ246IHRleHQtYm90dG9tJy8+Ig0KICAgICAgICApOw0KICAgICAgfSk7DQogICAgICB2YXIgc29ja2V0TXNnID0gew0KICAgICAgICBuaWNrbmFtZTogdGhpcy5uaWNrbmFtZSwNCiAgICAgICAgYXZhdGFyOiB0aGlzLmF2YXRhciwNCiAgICAgICAgY29udGVudDogdGhpcy5jb250ZW50LA0KICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkLA0KICAgICAgICB0eXBlOiAzLA0KICAgICAgICBpcEFkZHJlc3M6IHRoaXMuaXBBZGRyZXNzLA0KICAgICAgICBpcFNvdXJjZTogdGhpcy5pcFNvdXJjZQ0KICAgICAgfTsNCiAgICAgIHRoaXMuV2Vic29ja2V0TWVzc2FnZS50eXBlID0gMzsNCiAgICAgIHRoaXMuV2Vic29ja2V0TWVzc2FnZS5kYXRhID0gc29ja2V0TXNnOw0KICAgICAgdGhpcy53ZWJzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh0aGlzLldlYnNvY2tldE1lc3NhZ2UpKTsNCiAgICAgIHRoaXMuY29udGVudCA9ICIiOw0KICAgIH0sDQogICAgYWRkRW1vamkoa2V5KSB7DQogICAgICB0aGlzLmlzRW1vamkgPSBmYWxzZTsNCiAgICAgIHRoaXMuJHJlZnMuY2hhdElucHV0LmZvY3VzKCk7DQogICAgICB0aGlzLmNvbnRlbnQgKz0ga2V5Ow0KICAgIH0sDQogICAgLy8g5bGV56S66I+c5Y2VDQogICAgc2hvd0JhY2soaXRlbSwgaW5kZXgsIGUpIHsNCiAgICAgIHRoaXMuJHJlZnMuYmFja0J0bi5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICBpdGVtLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICB9KTsNCiAgICAgIGlmICgNCiAgICAgICAgaXRlbS5pcEFkZHJlc3MgPT0gdGhpcy5pcEFkZHJlc3MgfHwNCiAgICAgICAgKGl0ZW0udXNlcklkICE9IG51bGwgJiYgaXRlbS51c2VySWQgPT0gdGhpcy51c2VySWQpDQogICAgICApIHsNCiAgICAgICAgdGhpcy4kcmVmcy5iYWNrQnRuW2luZGV4XS5zdHlsZS5sZWZ0ID0gZS5vZmZzZXRYICsgInB4IjsNCiAgICAgICAgdGhpcy4kcmVmcy5iYWNrQnRuW2luZGV4XS5zdHlsZS5ib3R0b20gPSBlLm9mZnNldFkgKyAicHgiOw0KICAgICAgICB0aGlzLiRyZWZzLmJhY2tCdG5baW5kZXhdLnN0eWxlLmRpc3BsYXkgPSAiYmxvY2siOw0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g5pKk5Zue5raI5oGvDQogICAgYmFjayhpdGVtLCBpbmRleCkgew0KICAgICAgdmFyIHNvY2tldE1zZyA9IHsNCiAgICAgICAgaWQ6IGl0ZW0uaWQsDQogICAgICAgIGlzVm9pY2U6IGl0ZW0udHlwZSA9PSA1DQogICAgICB9Ow0KICAgICAgdGhpcy5XZWJzb2NrZXRNZXNzYWdlLnR5cGUgPSA0Ow0KICAgICAgdGhpcy5XZWJzb2NrZXRNZXNzYWdlLmRhdGEgPSBzb2NrZXRNc2c7DQogICAgICB0aGlzLndlYnNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHRoaXMuV2Vic29ja2V0TWVzc2FnZSkpOw0KICAgICAgdGhpcy4kcmVmcy5iYWNrQnRuW2luZGV4XS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIH0sDQogICAgY2xvc2VBbGwoKSB7DQogICAgICB0aGlzLmlzRW1vamkgPSBmYWxzZTsNCiAgICAgIGlmICh0aGlzLmNoYXRSZWNvcmRMaXN0Lmxlbmd0aCA+IDApIHsNCiAgICAgICAgdGhpcy4kcmVmcy5iYWNrQnRuLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgaXRlbS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOW9lemfs+W8gOWniw0KICAgIHRyYW5zbGF0aW9uU3RhcnQoKSB7DQogICAgICB0aGlzLnZvaWNlQWN0aXZlID0gdHJ1ZTsNCiAgICAgIGxldCB0aGF0ID0gdGhpczsNCiAgICAgIHRoYXQucmMgPSBuZXcgUmVjb3JkZXJ4KCk7DQogICAgICB0aGF0LiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoYXQucmMNCiAgICAgICAgICAuc3RhcnQoKQ0KICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIHRoYXQuc3RhcnRWb2ljZVRpbWUgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgY29uc29sZS5sb2coInN0YXJ0IHJlY29yZGluZyIpOw0KICAgICAgICAgIH0pDQogICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZWNvcmRpbmcgZmFpbGVkLiIsIGVycm9yKTsNCiAgICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g5b2V6Z+z57uT5p2fDQogICAgdHJhbnNsYXRpb25FbmQoKSB7DQogICAgICBjb25zb2xlLmxvZygi57uT5p2fIik7DQogICAgICB0aGlzLnZvaWNlQWN0aXZlID0gZmFsc2U7DQogICAgICB0aGlzLnJjLnBhdXNlKCk7DQogICAgICBpZiAobmV3IERhdGUoKSAtIHRoaXMuc3RhcnRWb2ljZVRpbWUgPCAxMDAwKSB7DQogICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogImVycm9yIiwgbWVzc2FnZTogIuaMiemUruaXtumXtOWkquefrSIgfSk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0NCiAgICAgIHZhciB3YXYgPSB0aGlzLnJjLmdldFJlY29yZCh7DQogICAgICAgIGVuY29kZVRvOiBFTkNPREVfVFlQRS5XQVYNCiAgICAgIH0pOw0KICAgICAgdmFyIGZpbGUgPSBuZXcgRmlsZShbd2F2XSwgInZvaWNlLndhdiIsIHsNCiAgICAgICAgdHlwZTogd2F2LnR5cGUNCiAgICAgIH0pOw0KICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IHdpbmRvdy5Gb3JtRGF0YSgpOw0KICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlIiwgZmlsZSk7DQogICAgICBmb3JtRGF0YS5hcHBlbmQoInR5cGUiLCA1KTsNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgibmlja25hbWUiLCB0aGlzLm5pY2tuYW1lKTsNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgiYXZhdGFyIiwgdGhpcy5hdmF0YXIpOw0KICAgICAgaWYgKHRoaXMudXNlcklkICE9IG51bGwpIHsNCiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJ1c2VySWQiLCB0aGlzLnVzZXJJZCk7DQogICAgICB9DQogICAgICBmb3JtRGF0YS5hcHBlbmQoImlwQWRkcmVzcyIsIHRoaXMuaXBBZGRyZXNzKTsNCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgiaXBTb3VyY2UiLCB0aGlzLmlwU291cmNlKTsNCiAgICAgIHZhciBvcHRpb25zID0gew0KICAgICAgICB1cmw6ICIvYXBpL3ZvaWNlIiwNCiAgICAgICAgZGF0YTogZm9ybURhdGEsDQogICAgICAgIG1ldGhvZDogInBvc3QiLA0KICAgICAgICBoZWFkZXJzOiB7DQogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIg0KICAgICAgICB9DQogICAgICB9Ow0KICAgICAgdGhpcy5heGlvcyhvcHRpb25zKTsNCiAgICB9LA0KICAgIHRyYW5zbGF0aW9ubW92ZSgpIHt9LA0KICAgIC8vIOaSreaUvuivremfsw0KICAgIHBsYXlWb2ljZShpdGVtKSB7DQogICAgICB2YXIgcGxheWVyID0gdGhpcy4kcmVmcy52b2ljZXNbdGhpcy52b2ljZUxpc3QuaW5kZXhPZihpdGVtLmlkKV07DQogICAgICBpZiAocGxheWVyLnBhdXNlZCkgew0KICAgICAgICBwbGF5ZXIucGxheSgpOw0KICAgICAgICB0aGlzLiRyZWZzLnBsYXlzW3RoaXMudm9pY2VMaXN0LmluZGV4T2YoaXRlbS5pZCldLiRlbC5zdHlsZS5kaXNwbGF5ID0NCiAgICAgICAgICAibm9uZSI7DQogICAgICAgIHRoaXMuJHJlZnMucGF1c2VzW3RoaXMudm9pY2VMaXN0LmluZGV4T2YoaXRlbS5pZCldLiRlbC5zdHlsZS5kaXNwbGF5ID0NCiAgICAgICAgICAiaW5saW5lLWZsZXgiOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kcmVmcy5wbGF5c1t0aGlzLnZvaWNlTGlzdC5pbmRleE9mKGl0ZW0uaWQpXS4kZWwuc3R5bGUuZGlzcGxheSA9DQogICAgICAgICAgImlubGluZS1mbGV4IjsNCiAgICAgICAgdGhpcy4kcmVmcy5wYXVzZXNbdGhpcy52b2ljZUxpc3QuaW5kZXhPZihpdGVtLmlkKV0uJGVsLnN0eWxlLmRpc3BsYXkgPQ0KICAgICAgICAgICJub25lIjsNCiAgICAgICAgcGxheWVyLnBhdXNlKCk7DQogICAgICB9DQogICAgfSwNCiAgICAvLyDor63pn7Pnu5PmnZ8NCiAgICBlbmRWb2ljZShpdGVtKSB7DQogICAgICB0aGlzLiRyZWZzLnBsYXlzW3RoaXMudm9pY2VMaXN0LmluZGV4T2YoaXRlbS5pZCldLiRlbC5zdHlsZS5kaXNwbGF5ID0NCiAgICAgICAgImlubGluZS1mbGV4IjsNCiAgICAgIHRoaXMuJHJlZnMucGF1c2VzW3RoaXMudm9pY2VMaXN0LmluZGV4T2YoaXRlbS5pZCldLiRlbC5zdHlsZS5kaXNwbGF5ID0NCiAgICAgICAgIm5vbmUiOw0KICAgIH0sDQogICAgLy8g6I635Y+W6K+t6Z+z5pe26ZW/DQogICAgZ2V0Vm9pY2VUaW1lKGl0ZW0pIHsNCiAgICAgIHZhciB0aW1lID0gdGhpcy4kcmVmcy52b2ljZXNbdGhpcy52b2ljZUxpc3QuaW5kZXhPZihpdGVtLmlkKV0uZHVyYXRpb247DQogICAgICB0aW1lID0gTWF0aC5jZWlsKHRpbWUpOw0KICAgICAgdmFyIHN0ciA9ICLirJ3irJ3irJ0iOw0KICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aW1lOyBpKyspIHsNCiAgICAgICAgaWYgKGkgJSAyID09IDApIHsNCiAgICAgICAgICBzdHIgKz0gIuKsnSI7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHRoaXMuJHJlZnMudm9pY2VUaW1lc1t0aGlzLnZvaWNlTGlzdC5pbmRleE9mKGl0ZW0uaWQpXS5pbm5lckhUTUwgPQ0KICAgICAgICAiICIgKyBzdHIgKyAiICIgKyB0aW1lICsgIiAnJyI7DQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGlzU2VsZigpIHsNCiAgICAgIHJldHVybiBmdW5jdGlvbihpdGVtKSB7DQogICAgICAgIHJldHVybiAoDQogICAgICAgICAgaXRlbS5pcEFkZHJlc3MgPT0gdGhpcy5pcEFkZHJlc3MgfHwNCiAgICAgICAgICAoaXRlbS51c2VySWQgIT0gbnVsbCAmJiBpdGVtLnVzZXJJZCA9PSB0aGlzLnVzZXJJZCkNCiAgICAgICAgKTsNCiAgICAgIH07DQogICAgfSwNCiAgICBpc2xlZnQoKSB7DQogICAgICByZXR1cm4gZnVuY3Rpb24oaXRlbSkgew0KICAgICAgICByZXR1cm4gdGhpcy5pc1NlbGYoaXRlbSkNCiAgICAgICAgICA/ICJ1c2VyLWF2YXRhciByaWdodC1hdmF0YXIiDQogICAgICAgICAgOiAidXNlci1hdmF0YXIgbGVmdC1hdmF0YXIiOw0KICAgICAgfTsNCiAgICB9LA0KICAgIGlzTXlDb250ZW50KCkgew0KICAgICAgcmV0dXJuIGZ1bmN0aW9uKGl0ZW0pIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuaXNTZWxmKGl0ZW0pID8gIm15LWNvbnRlbnQiIDogInVzZXItY29udGVudCI7DQogICAgICB9Ow0KICAgIH0sDQogICAgaXNNeU1lc3NhZ2UoKSB7DQogICAgICByZXR1cm4gZnVuY3Rpb24oaXRlbSkgew0KICAgICAgICByZXR1cm4gdGhpcy5pc1NlbGYoaXRlbSkgPyAibXktbWVzc2FnZSIgOiAidXNlci1tZXNzYWdlIjsNCiAgICAgIH07DQogICAgfSwNCiAgICBibG9nSW5mbygpIHsNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5ibG9nSW5mbzsNCiAgICB9LA0KICAgIG5pY2tuYW1lKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLm5pY2tuYW1lICE9IG51bGwNCiAgICAgICAgPyB0aGlzLiRzdG9yZS5zdGF0ZS5uaWNrbmFtZQ0KICAgICAgICA6IHRoaXMuaXBBZGRyZXNzOw0KICAgIH0sDQogICAgYXZhdGFyKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmF2YXRhciAhPSBudWxsDQogICAgICAgID8gdGhpcy4kc3RvcmUuc3RhdGUuYXZhdGFyDQogICAgICAgIDogdGhpcy4kc3RvcmUuc3RhdGUuYmxvZ0luZm8ud2Vic2l0ZUNvbmZpZy50b3VyaXN0QXZhdGFyOw0KICAgIH0sDQogICAgdXNlcklkKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJZDsNCiAgICB9LA0KICAgIGlzSW5wdXQoKSB7DQogICAgICByZXR1cm4gdGhpcy5jb250ZW50LnRyaW0oKSAhPSAiIg0KICAgICAgICA/ICJpY29uZm9udCBpY29uemhpZmVpamkgc3VibWl0LWJ0biINCiAgICAgICAgOiAiaWNvbmZvbnQgaWNvbnpoaWZlaWppIjsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["ChatRoom.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChatRoom.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 聊天界面 -->\r\n    <div\r\n      class=\"chat-container animated bounceInUp\"\r\n      v-show=\"isShow\"\r\n      @click=\"closeAll\"\r\n      @contextmenu.prevent.stop=\"closeAll\"\r\n    >\r\n      <!-- 标题 -->\r\n      <div class=\"header\">\r\n        <img\r\n          width=\"32\"\r\n          height=\"32\"\r\n          src=\"https://static.talkxj.com/config/logo.png\"\r\n        />\r\n        <div style=\"margin-left:12px\">\r\n          <div>聊天室</div>\r\n          <div style=\"font-size:12px\">当前{{ count }}人在线</div>\r\n        </div>\r\n        <v-icon class=\"close\" @click=\"isShow = false\">\r\n          mdi-close\r\n        </v-icon>\r\n      </div>\r\n      <!-- 对话内容 -->\r\n      <div class=\"message\" id=\"message\">\r\n        <!-- 录音遮罩层 -->\r\n        <div\r\n          v-show=\"voiceActive\"\r\n          class=\"voice\"\r\n          @mousemove.prevent.stop=\"translationmove($event)\"\r\n          @mouseup.prevent.stop=\"translationEnd($event)\"\r\n        >\r\n          <v-icon ref=\"voiceClose\" class=\"close-voice\">mdi-close</v-icon>\r\n        </div>\r\n        <div\r\n          :class=\"isMyMessage(item)\"\r\n          v-for=\"(item, index) of chatRecordList\"\r\n          :key=\"index\"\r\n        >\r\n          <!-- 头像 -->\r\n          <img :src=\"item.avatar\" :class=\"isleft(item)\" />\r\n          <div>\r\n            <div class=\"nickname\" v-if=\"!isSelf(item)\">\r\n              {{ item.nickname }}\r\n              <span style=\"margin-left:12px\">{{ item.createTime | hour }}</span>\r\n            </div>\r\n            <!-- 内容 -->\r\n            <div\r\n              ref=\"content\"\r\n              @contextmenu.prevent.stop=\"showBack(item, index, $event)\"\r\n              :class=\"isMyContent(item)\"\r\n            >\r\n              <!-- 文字消息 -->\r\n              <div v-if=\"item.type == 3\" v-html=\"item.content\" />\r\n              <!-- 语音消息 -->\r\n              <div v-if=\"item.type == 5\" @click.prevent.stop=\"playVoice(item)\">\r\n                <audio\r\n                  @ended=\"endVoice(item)\"\r\n                  @canplay=\"getVoiceTime(item)\"\r\n                  ref=\"voices\"\r\n                  :src=\"item.content\"\r\n                  style=\"display:none\"\r\n                />\r\n                <!-- 播放 -->\r\n                <v-icon\r\n                  :color=\"isSelf(item) ? '#fff' : '#000'\"\r\n                  ref=\"plays\"\r\n                  style=\"display:inline-flex;cursor: pointer;\"\r\n                >\r\n                  mdi-arrow-right-drop-circle\r\n                </v-icon>\r\n                <!-- 暂停 -->\r\n                <v-icon\r\n                  :color=\"isSelf(item) ? '#fff' : '#000'\"\r\n                  ref=\"pauses\"\r\n                  style=\"display:none;cursor: pointer;\"\r\n                >\r\n                  mdi-pause-circle\r\n                </v-icon>\r\n                <!-- 音频时长 -->\r\n                <span ref=\"voiceTimes\" />\r\n              </div>\r\n              <div class=\"back-menu\" ref=\"backBtn\" @click=\"back(item, index)\">\r\n                撤回\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- 输入框 -->\r\n      <div class=\"footer\">\r\n        <!-- 表情框 -->\r\n        <div class=\"emoji-box\" v-show=\"isEmoji\">\r\n          <Emoji :chooseEmoji=\"true\" @addEmoji=\"addEmoji\" />\r\n        </div>\r\n        <div class=\"emoji-border\" v-show=\"isEmoji\" />\r\n        <!-- 切换输入方式 -->\r\n        <v-icon\r\n          v-show=\"!isVoice\"\r\n          @click=\"isVoice = !isVoice\"\r\n          style=\"margin-right: 8px\"\r\n        >\r\n          mdi-microphone\r\n        </v-icon>\r\n        <v-icon\r\n          v-show=\"isVoice\"\r\n          @click=\"isVoice = !isVoice\"\r\n          style=\"margin-right: 8px\"\r\n        >\r\n          mdi-keyboard\r\n        </v-icon>\r\n        <!-- 文字输入 -->\r\n        <textarea\r\n          v-show=\"!isVoice\"\r\n          ref=\"chatInput\"\r\n          v-model=\"content\"\r\n          @keydown.enter=\"saveMessage($event)\"\r\n          placeholder=\"请输入内容\"\r\n        />\r\n        <!-- 语音输入 -->\r\n        <button\r\n          class=\"voice-btn\"\r\n          v-show=\"isVoice\"\r\n          @mousedown.prevent.stop=\"translationStart\"\r\n          @mouseup.prevent.stop=\"translationEnd($event)\"\r\n          @touchstart.prevent.stop=\"translationStart\"\r\n          @touchend.prevent.stop=\"translationEnd($event)\"\r\n          @touchmove.prevent.stop=\"translationmove($event)\"\r\n        >\r\n          按住说话\r\n        </button>\r\n        <!-- 表情 -->\r\n        <i\r\n          class=\"iconfont iconbiaoqing emoji\"\r\n          :style=\"isEmoji ? 'color:#FFC83D' : ''\"\r\n          @click.prevent.stop=\"openEmoji\"\r\n        />\r\n        <!-- 发送按钮 -->\r\n        <i :class=\"isInput\" @click=\"saveMessage\" style=\"font-size: 1.5rem\" />\r\n      </div>\r\n    </div>\r\n    <!-- 未读数量 -->\r\n    <div class=\"chat-btn\" @click=\"open\">\r\n      <span class=\"unread\" v-if=\"unreadCount > 0\">{{ unreadCount }}</span>\r\n      <img\r\n        width=\"100%\"\r\n        height=\"100%\"\r\n        src=\"https://static.talkxj.com/config/logo.png\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Recorderx, { ENCODE_TYPE } from \"recorderx\";\r\nimport Emoji from \"./Emoji\";\r\nimport EmojiList from \"../assets/js/emoji\";\r\nexport default {\r\n  components: {\r\n    Emoji\r\n  },\r\n  updated() {\r\n    var ele = document.getElementById(\"message\");\r\n    ele.scrollTop = ele.scrollHeight;\r\n  },\r\n  beforeDestroy() {\r\n    clearInterval(this.heartBeat);\r\n  },\r\n  data: function() {\r\n    return {\r\n      isEmoji: false,\r\n      isShow: false,\r\n      websocket: null,\r\n      content: \"\",\r\n      chatRecordList: [],\r\n      voiceList: [],\r\n      rc: null,\r\n      ipAddress: \"\",\r\n      ipSource: \"\",\r\n      count: 0,\r\n      unreadCount: 0,\r\n      isVoice: false,\r\n      voiceActive: false,\r\n      startVoiceTime: null,\r\n      WebsocketMessage: {\r\n        type: null,\r\n        data: null\r\n      },\r\n      heartBeat: null\r\n    };\r\n  },\r\n  methods: {\r\n    open() {\r\n      if (this.websocket == null) {\r\n        this.connect();\r\n      }\r\n      this.unreadCount = 0;\r\n      this.isShow = !this.isShow;\r\n    },\r\n    openEmoji() {\r\n      this.isEmoji = !this.isEmoji;\r\n      this.isVoice = false;\r\n    },\r\n    connect() {\r\n      var that = this;\r\n      this.websocket = new WebSocket(this.blogInfo.websiteConfig.websocketUrl);\r\n      // 连接发生错误的回调方法\r\n      this.websocket.onerror = function(event) {\r\n        console.log(event);\r\n        alert(\"失败\");\r\n      };\r\n      // 连接成功建立的回调方法\r\n      this.websocket.onopen = function(event) {\r\n        console.log(event);\r\n        // 发送心跳消息\r\n        that.heartBeat = setInterval(function() {\r\n          var beatMessage = {\r\n            type: 6,\r\n            data: \"ping\"\r\n          };\r\n          that.websocket.send(JSON.stringify(beatMessage));\r\n        }, 30 * 1000);\r\n      };\r\n      // 接收到消息的回调方法\r\n      this.websocket.onmessage = function(event) {\r\n        const data = JSON.parse(event.data);\r\n        switch (data.type) {\r\n          case 1:\r\n            // 在线人数\r\n            that.count = data.data;\r\n            break;\r\n          case 2:\r\n            // 历史记录\r\n            that.chatRecordList = data.data.chatRecordList;\r\n            that.chatRecordList.forEach(item => {\r\n              if (item.type == 5) {\r\n                that.voiceList.push(item.id);\r\n              }\r\n            });\r\n            that.ipAddress = data.data.ipAddress;\r\n            that.ipSource = data.data.ipSource;\r\n            break;\r\n          case 3:\r\n            // 文字消息\r\n            that.chatRecordList.push(data.data);\r\n            if (!that.isShow) {\r\n              that.unreadCount++;\r\n            }\r\n            break;\r\n          case 4:\r\n            // 撤回\r\n            if (data.data.isVoice) {\r\n              that.voiceList.splice(that.voiceList.indexOf(data.data.id), 1);\r\n            }\r\n            for (var i = 0; i < that.chatRecordList.length; i++) {\r\n              if (that.chatRecordList[i].id == data.data.id) {\r\n                that.chatRecordList.splice(i, 1);\r\n                i--;\r\n              }\r\n            }\r\n            break;\r\n          case 5:\r\n            // 语音消息\r\n            that.voiceList.push(data.data.id);\r\n            that.chatRecordList.push(data.data);\r\n            if (!that.isShow) {\r\n              that.unreadCount++;\r\n            }\r\n            break;\r\n        }\r\n      };\r\n      //连接关闭的回调方法\r\n      this.websocket.onclose = function() {};\r\n    },\r\n    saveMessage(e) {\r\n      e.preventDefault();\r\n      if (this.content.trim() == \"\") {\r\n        this.$toast({ type: \"error\", message: \"内容不能为空\" });\r\n        return false;\r\n      }\r\n      //解析表情\r\n      var reg = /\\[.+?\\]/g;\r\n      this.content = this.content.replace(reg, function(str) {\r\n        return (\r\n          \"<img src= '\" +\r\n          EmojiList[str] +\r\n          \"' width='24'height='24' style='margin: 0 1px;vertical-align: text-bottom'/>\"\r\n        );\r\n      });\r\n      var socketMsg = {\r\n        nickname: this.nickname,\r\n        avatar: this.avatar,\r\n        content: this.content,\r\n        userId: this.userId,\r\n        type: 3,\r\n        ipAddress: this.ipAddress,\r\n        ipSource: this.ipSource\r\n      };\r\n      this.WebsocketMessage.type = 3;\r\n      this.WebsocketMessage.data = socketMsg;\r\n      this.websocket.send(JSON.stringify(this.WebsocketMessage));\r\n      this.content = \"\";\r\n    },\r\n    addEmoji(key) {\r\n      this.isEmoji = false;\r\n      this.$refs.chatInput.focus();\r\n      this.content += key;\r\n    },\r\n    // 展示菜单\r\n    showBack(item, index, e) {\r\n      this.$refs.backBtn.forEach(item => {\r\n        item.style.display = \"none\";\r\n      });\r\n      if (\r\n        item.ipAddress == this.ipAddress ||\r\n        (item.userId != null && item.userId == this.userId)\r\n      ) {\r\n        this.$refs.backBtn[index].style.left = e.offsetX + \"px\";\r\n        this.$refs.backBtn[index].style.bottom = e.offsetY + \"px\";\r\n        this.$refs.backBtn[index].style.display = \"block\";\r\n      }\r\n    },\r\n    // 撤回消息\r\n    back(item, index) {\r\n      var socketMsg = {\r\n        id: item.id,\r\n        isVoice: item.type == 5\r\n      };\r\n      this.WebsocketMessage.type = 4;\r\n      this.WebsocketMessage.data = socketMsg;\r\n      this.websocket.send(JSON.stringify(this.WebsocketMessage));\r\n      this.$refs.backBtn[index].style.display = \"none\";\r\n    },\r\n    closeAll() {\r\n      this.isEmoji = false;\r\n      if (this.chatRecordList.length > 0) {\r\n        this.$refs.backBtn.forEach(item => {\r\n          item.style.display = \"none\";\r\n        });\r\n      }\r\n    },\r\n    // 录音开始\r\n    translationStart() {\r\n      this.voiceActive = true;\r\n      let that = this;\r\n      that.rc = new Recorderx();\r\n      that.$nextTick(() => {\r\n        that.rc\r\n          .start()\r\n          .then(() => {\r\n            that.startVoiceTime = new Date();\r\n            console.log(\"start recording\");\r\n          })\r\n          .catch(error => {\r\n            console.log(\"Recording failed.\", error);\r\n          });\r\n      });\r\n    },\r\n    // 录音结束\r\n    translationEnd() {\r\n      console.log(\"结束\");\r\n      this.voiceActive = false;\r\n      this.rc.pause();\r\n      if (new Date() - this.startVoiceTime < 1000) {\r\n        this.$toast({ type: \"error\", message: \"按键时间太短\" });\r\n        return false;\r\n      }\r\n      var wav = this.rc.getRecord({\r\n        encodeTo: ENCODE_TYPE.WAV\r\n      });\r\n      var file = new File([wav], \"voice.wav\", {\r\n        type: wav.type\r\n      });\r\n      var formData = new window.FormData();\r\n      formData.append(\"file\", file);\r\n      formData.append(\"type\", 5);\r\n      formData.append(\"nickname\", this.nickname);\r\n      formData.append(\"avatar\", this.avatar);\r\n      if (this.userId != null) {\r\n        formData.append(\"userId\", this.userId);\r\n      }\r\n      formData.append(\"ipAddress\", this.ipAddress);\r\n      formData.append(\"ipSource\", this.ipSource);\r\n      var options = {\r\n        url: \"/api/voice\",\r\n        data: formData,\r\n        method: \"post\",\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\"\r\n        }\r\n      };\r\n      this.axios(options);\r\n    },\r\n    translationmove() {},\r\n    // 播放语音\r\n    playVoice(item) {\r\n      var player = this.$refs.voices[this.voiceList.indexOf(item.id)];\r\n      if (player.paused) {\r\n        player.play();\r\n        this.$refs.plays[this.voiceList.indexOf(item.id)].$el.style.display =\r\n          \"none\";\r\n        this.$refs.pauses[this.voiceList.indexOf(item.id)].$el.style.display =\r\n          \"inline-flex\";\r\n      } else {\r\n        this.$refs.plays[this.voiceList.indexOf(item.id)].$el.style.display =\r\n          \"inline-flex\";\r\n        this.$refs.pauses[this.voiceList.indexOf(item.id)].$el.style.display =\r\n          \"none\";\r\n        player.pause();\r\n      }\r\n    },\r\n    // 语音结束\r\n    endVoice(item) {\r\n      this.$refs.plays[this.voiceList.indexOf(item.id)].$el.style.display =\r\n        \"inline-flex\";\r\n      this.$refs.pauses[this.voiceList.indexOf(item.id)].$el.style.display =\r\n        \"none\";\r\n    },\r\n    // 获取语音时长\r\n    getVoiceTime(item) {\r\n      var time = this.$refs.voices[this.voiceList.indexOf(item.id)].duration;\r\n      time = Math.ceil(time);\r\n      var str = \"⬝⬝⬝\";\r\n      for (var i = 0; i < time; i++) {\r\n        if (i % 2 == 0) {\r\n          str += \"⬝\";\r\n        }\r\n      }\r\n      this.$refs.voiceTimes[this.voiceList.indexOf(item.id)].innerHTML =\r\n        \" \" + str + \" \" + time + \" ''\";\r\n    }\r\n  },\r\n  computed: {\r\n    isSelf() {\r\n      return function(item) {\r\n        return (\r\n          item.ipAddress == this.ipAddress ||\r\n          (item.userId != null && item.userId == this.userId)\r\n        );\r\n      };\r\n    },\r\n    isleft() {\r\n      return function(item) {\r\n        return this.isSelf(item)\r\n          ? \"user-avatar right-avatar\"\r\n          : \"user-avatar left-avatar\";\r\n      };\r\n    },\r\n    isMyContent() {\r\n      return function(item) {\r\n        return this.isSelf(item) ? \"my-content\" : \"user-content\";\r\n      };\r\n    },\r\n    isMyMessage() {\r\n      return function(item) {\r\n        return this.isSelf(item) ? \"my-message\" : \"user-message\";\r\n      };\r\n    },\r\n    blogInfo() {\r\n      return this.$store.state.blogInfo;\r\n    },\r\n    nickname() {\r\n      return this.$store.state.nickname != null\r\n        ? this.$store.state.nickname\r\n        : this.ipAddress;\r\n    },\r\n    avatar() {\r\n      return this.$store.state.avatar != null\r\n        ? this.$store.state.avatar\r\n        : this.$store.state.blogInfo.websiteConfig.touristAvatar;\r\n    },\r\n    userId() {\r\n      return this.$store.state.userId;\r\n    },\r\n    isInput() {\r\n      return this.content.trim() != \"\"\r\n        ? \"iconfont iconzhifeiji submit-btn\"\r\n        : \"iconfont iconzhifeiji\";\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n@media (min-width: 760px) {\r\n  .chat-container {\r\n    position: fixed;\r\n    color: #4c4948 !important;\r\n    bottom: 104px;\r\n    right: 20px;\r\n    height: calc(85% - 64px - 20px);\r\n    max-height: 590px !important;\r\n    min-height: 250px !important;\r\n    width: 400px !important;\r\n    border-radius: 16px !important;\r\n  }\r\n  .close {\r\n    display: none;\r\n  }\r\n}\r\n@media (max-width: 760px) {\r\n  .chat-container {\r\n    position: fixed;\r\n    top: 0;\r\n    bottom: 0;\r\n    right: 0;\r\n    left: 0;\r\n  }\r\n  .close {\r\n    display: block;\r\n    margin-left: auto;\r\n  }\r\n}\r\n.chat-container {\r\n  box-shadow: 0 5px 40px rgba(0, 0, 0, 0.16) !important;\r\n  font-size: 14px;\r\n  background: #f4f6fb;\r\n  z-index: 1200;\r\n}\r\n.chat-btn {\r\n  background: #1f93ff;\r\n  border-radius: 100px !important;\r\n  position: fixed;\r\n  bottom: 15px;\r\n  right: 5px;\r\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.16) !important;\r\n  cursor: pointer;\r\n  height: 60px !important;\r\n  width: 60px !important;\r\n  z-index: 1000 !important;\r\n  user-select: none;\r\n}\r\n.header {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 20px 24px;\r\n  background: #ffffff;\r\n  border-radius: 1rem 1rem 0 0;\r\n  box-shadow: 0 10px 15px -16px rgba(50, 50, 93, 0.08),\r\n    0 4px 6px -8px rgba(50, 50, 93, 0.04);\r\n}\r\n.footer {\r\n  padding: 8px 16px;\r\n  position: absolute;\r\n  width: 100%;\r\n  bottom: 0;\r\n  background: #f7f7f7;\r\n  border-radius: 0 0 1rem 1rem;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n.footer textarea {\r\n  background: #fff;\r\n  padding-left: 10px;\r\n  padding-top: 8px;\r\n  width: 100%;\r\n  height: 32px;\r\n  outline: none;\r\n  resize: none;\r\n  overflow: hidden;\r\n  font-size: 13px;\r\n}\r\n.voice-btn {\r\n  font-size: 13px;\r\n  outline: none;\r\n  height: 32px;\r\n  width: 100%;\r\n  background: #fff;\r\n  border-radius: 2px;\r\n}\r\n.message {\r\n  position: absolute;\r\n  width: 100%;\r\n  padding: 20px 16px 0 16px;\r\n  top: 80px;\r\n  bottom: 50px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n}\r\n.text {\r\n  color: #999;\r\n  text-align: center;\r\n  font-size: 12px;\r\n  margin-bottom: 12px;\r\n}\r\n.user-message {\r\n  display: flex;\r\n  margin-bottom: 10px;\r\n}\r\n.my-message {\r\n  display: flex;\r\n  margin-bottom: 10px;\r\n  justify-content: flex-end;\r\n}\r\n.left-avatar {\r\n  margin-right: 10px;\r\n}\r\n.right-avatar {\r\n  order: 1;\r\n  margin-left: 10px;\r\n}\r\n.user-avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n}\r\n.nickname {\r\n  display: flex;\r\n  align-items: center;\r\n  font-size: 12px;\r\n  margin-top: 3px;\r\n  margin-bottom: 5px;\r\n}\r\n.user-content {\r\n  position: relative;\r\n  background-color: #fff;\r\n  padding: 10px;\r\n  border-radius: 5px 20px 20px 20px;\r\n  width: fit-content;\r\n  white-space: pre-line;\r\n  word-wrap: break-word;\r\n  word-break: break-all;\r\n}\r\n.my-content {\r\n  position: relative;\r\n  border-radius: 20px 5px 20px 20px;\r\n  padding: 12px;\r\n  background: #12b7f5;\r\n  color: #fff;\r\n  white-space: pre-line;\r\n  word-wrap: break-word;\r\n  word-break: break-all;\r\n}\r\n.submit-btn {\r\n  color: rgb(31, 147, 255);\r\n}\r\n.emoji {\r\n  cursor: pointer;\r\n  font-size: 1.3rem;\r\n  margin: 0 8px;\r\n}\r\n.emoji-box {\r\n  position: absolute;\r\n  box-shadow: 0 8px 16px rgba(50, 50, 93, 0.08), 0 4px 12px rgba(0, 0, 0, 0.07);\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  right: 20px;\r\n  bottom: 52px;\r\n  height: 180px;\r\n  width: 300px;\r\n  overflow-y: auto;\r\n  padding: 6px 16px;\r\n}\r\n.emoji-border:before {\r\n  display: block;\r\n  height: 0;\r\n  width: 0;\r\n  content: \"\";\r\n  border-left: 14px solid transparent;\r\n  border-right: 14px solid transparent;\r\n  border-top: 12px solid #fff;\r\n  bottom: 40px;\r\n  position: absolute;\r\n  right: 43px;\r\n}\r\n.unread {\r\n  text-align: center;\r\n  border-radius: 50%;\r\n  font-size: 14px;\r\n  height: 20px;\r\n  width: 20px;\r\n  position: absolute;\r\n  background: #f24f2d;\r\n  color: #fff;\r\n}\r\n.back-menu {\r\n  font-size: 13px;\r\n  border-radius: 2px;\r\n  position: absolute;\r\n  background: rgba(255, 255, 255, 0.9);\r\n  color: #000;\r\n  width: 80px;\r\n  height: 35px;\r\n  text-align: center;\r\n  line-height: 35px;\r\n  display: none;\r\n}\r\n.voice {\r\n  position: fixed;\r\n  z-index: 1500;\r\n  bottom: 52px;\r\n  left: 0;\r\n  right: 0;\r\n  top: 80px;\r\n  background: rgba(0, 0, 0, 0.8);\r\n}\r\n.close-voice {\r\n  position: absolute;\r\n  bottom: 60px;\r\n  left: 30px;\r\n  display: inline-block;\r\n  height: 50px;\r\n  width: 50px;\r\n  line-height: 50px;\r\n  border-radius: 50%;\r\n  text-align: center;\r\n  background: #fff;\r\n}\r\n</style>\r\n"]}]}